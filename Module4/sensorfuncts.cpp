#include "sensorfuncts.h"
#include "mbed.h"

AnalogIn VREFL_in(PTB0);
extern float sampleAlg(float freq, float temp_degC);
int k = 0;

void adc_configure_opt0()
{
    SIM->SCGC6 |= (0b1<<27);    											//Enable clock for ADC0
    
    uint8_t adc_0_cfg1_mask = 0xff;
    ADC0->CFG1 &= ~adc_0_cfg1_mask;
    ADC0->CFG1 |= 0b00010000;    											//Select Normal power, divide ratio 1, long sample time, 8-bit conversion, bus clock
    
    uint8_t adc_0_sc2_mask = 0b01000011;
    ADC0->SC2 &= ~adc_0_sc2_mask;
    ADC0->SC2 |= 0x00;          											//Select software trigger, voltage ref VREFH and VREFL
    
};

void adc_configure_opt1()
{
    SIM->SCGC6 |= (0b1<<27);    											//Enable clock for ADC0
    
    uint8_t adc_0_cfg1_mask = 0xff;
    ADC0->CFG1 &= ~adc_0_cfg1_mask;
    ADC0->CFG1 |= 0b00011100;    											//Select Normal power, divide ratio 1, long sample time, 16-bit conversion, bus clock
    
    uint8_t adc_0_sc2_mask = 0b01000011;
    ADC0->SC2 &= ~adc_0_sc2_mask;
    ADC0->SC2 |= 0x00;          											//Select software trigger, voltage ref VREFH and VREFL


    ADC0->SC3 |= (0x1 << 3);     		     							 	//Enable continous conversion mode
};


float adc_read_8bit()
{
    //Writing to SC1 triggers a new conversion, 
    uint8_t adc_0_sc1a_mask = 0b00111111;
    ADC0->SC1[0] &= ~adc_0_sc1a_mask;
    ADC0->SC1[0] |= (0b001000); 											//Select single ended,channel 8 (PTB0)
    
    volatile int coco = ((ADC0->SC1[0] & 0x80) >> 7);   					//conversion complete flag
    while(!coco){   														//wait until conversion is complete 
        coco = ((ADC0->SC1[0] & 0x80) >> 7);      							//compiler does not seem to recognize the voltaile
    }    
    float result = ADC0->R[0];
    result =  result * 3.30 / 256;
    
    return result;
};

float adc_read_16bit(int sel)
{
    //Writing to SC1 triggers a new conversion, 
    uint8_t adc_0_sc1a_mask = 0b00111111;
    ADC0->SC1[0] &= ~adc_0_sc1a_mask;
    
    if(sel) 																//Temperature sensor
        ADC0->SC1[0] |= (0b011010); 										//Select single ended, channel 26 (Internal temp)
    else    																//virtual vortex frequency
        ADC0->SC1[0] |= (0b001001); 
        																	//Select single ended, channel 9 (J10_4/PTB2)
    volatile int coco = ((ADC0->SC1[0] & 0x80) >> 7);   					//conversion complete flag
    while(!coco){   														//wait until conversion is complete 
        coco = ((ADC0->SC1[0] & 0x80) >> 7);     			  				//compiler does not seem to recognize the voltaile
    }    

    
    float result = ADC0->R[0];
    result =  result * 330.0 / 65536; 										//330mv is the max output of the temperature sensor

    return result;
};

int adc_calibrate()
{
    //Run calibration and move results to plus gain and minus gain registers 
    ADC0->SC3 |= 0x80;
    uint8_t plus = ADC0->CLP3 & 0xff;
    ADC0->PG |= plus;
    uint8_t minus = ADC0->CLM3 & 0xff;
    ADC0->MG |= minus;
    
	    uint8_t cal_complete = (0b1<<6);    								//Calibration failed flag
    if( ((ADC0->SC3 & cal_complete) >> 6) )
        return 0;
    else
        return 1;    
};

float spi_lcd()
{
	SPI spi(PTC6, PTC7, PTC5); // mosi, miso, sck
	DigitalOut cs(PTC4);

    float freq_data_rate[] = {81.49, 81.49, 76.37, 66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37}; 		

	// get the temperature 
    adc_configure_opt1();
    while(adc_calibrate());
    float temp = adc_read_16bit(1); 								//Internal temp
 
    // calculate data flow
    float freqDataRate = freq_data_rate[k];
    float dataFlow = sampleAlg(freqDataRate, temp);

    // deselect device
    cs = 1;
                
    spi.format(8,0);
    spi.frequency(1000000);
 
   // select device (set low)
    cs = 0;
    
    // send flow data
    spi.write((uint16_t)dataFlow);
 
    // receive the contents of slave register
    int output = spi.write(0);
 
    // Deselect the device
    cs = 1;
};
  
//  4-20 output ()    // use TMP0 channel 3  proporional rate to flow
float flowPulse()
{
    PwmOut TPM0_3(PTE30);
    int i = 0;
    while(1)
    {
    	// get the temperature 
    	adc_configure_opt1();
    	while(adc_calibrate());
    	float temp = adc_read_16bit(1); 								//Internal temp
             
    	// get the frequency 
    	float freq_data_rate[] = {81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37}; 
    
    	// calculate data flow
    	float freqDataRate = freq_data_rate[i];
    	float flow = sampleAlg(freqDataRate, temp);
     
    	TPM0_3.period(flow);     
    	TPM0_3 = 0;
    	i++;
    }       
};

//  Pulse output()   // use TMP0 channel 4  propotional rate to frequency
int freqPulse()
{
    PwmOut TPM0_4(PTE31);
    int i = 0;
    while(1)
    {
    	float freq_data_rate[] = {81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37,81.49,81.49,76.37,66.45,52.36,34.97,15.39,5.16,25.38,44.01,59.88,71.97,79.56,82.14,79.56,71.97,59.88,44.01,25.38,5.16,15.39,34.97,52.36,66.45,76.37}; 

    	TPM0_4.period(freq_data_rate[i]);   
    	TPM0_4 = 0;
	i++;
	}
};
